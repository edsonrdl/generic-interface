<div class="layout-wrapper" [ngClass]="containerClass">
    <!-- TopBar é crítico, carrega imediatamente -->
    <app-top-bar></app-top-bar>

    <!-- SideBar com defer - carrega sob demanda -->
    @defer (on viewport; prefetch on idle) {
        <app-side-bar></app-side-bar>
    } @placeholder {
        <div class="sidebar-skeleton">
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
            <div class="skeleton-item"></div>
        </div>
    }

    <div class="layout-main-container">
        <div class="layout-main">
            <router-outlet></router-outlet>
        </div>
        
        <!-- Footer com defer - carrega quando visível -->
        @defer (on viewport) {
            <app-footer></app-footer>
        } @placeholder {
            <div class="footer-placeholder">
                <div class="skeleton-footer"></div>
            </div>
        }
    </div>
    
    <div class="layout-mask animate-fadein"></div>
</div>